facet_grid(.~Platform) +
labs(title="Distribution of games for each year for each platform") +
theme(axis.text.x = element_text(angle = -90, size=6))
vg <- games_new
vg$Platform =
ifelse(vg$Platform %in% top_platforms$Platform, vg$Platform, "Other")
vg = vg[complete.cases(vg),]
vg %>%
group_by(Platform, Year) %>%
summarise(count=n()) %>%
ggplot(aes(x=Year, y=count, fill=Platform)) +
geom_bar(stat="identity") +
facet_grid(.~Platform) +
labs(title="Distribution of games for each year for each platform") +
theme(axis.text.x = element_text(angle = -90, size=6))
top3 = vg %>%
group_by(Platform) %>%
summarise(count=n()) %>%
arrange(desc(count)) %>%
head(3)
```
View(games_new)
vg <- games_new
vg <- games_new
top3 = vg %>%
group_by(Platform) %>%
summarise(count=n()) %>%
arrange(desc(count)) %>%
head(3)
```
top3 = vg %>%
group_by(Platform) %>%
summarise(count=n()) %>%
arrange(desc(count)) %>%
head(top3)
vg = read.csv("Video_Games.csv", stringsAsFactors = F)
library(dplyr)
vg = vg %>% select(-c("Publisher", "JP_Sales", "Critic_Count", "User_Count", "Developer"))
# There is no GP_Sales in dataset, hece, I used Global_Sales instead
vg[c("NA_Sales", "EU_Sales", "Global_Sales")] = vg[c("NA_Sales", "EU_Sales", "Global_Sales")] %>% lapply(function(x)x*1000000)
vg = vg %>% filter(NA_Sales>=20000 & EU_Sales>=20000 & Rating %in% c("E", "M", "T", "E10+", "A0"))
str(vg)
vg$Year = as.numeric(vg$Year)
table(vg$Year, useNA = c("ifany"))
vg$User_Score = as.numeric(vg$User_Score)
unique(vg$User_Score)
vg$Critic_Score = ifelse(vg$Critic_Score > 100, NA, vg$Critic_Score)
vg$User_Score = ifelse(vg$User_Score > 10, NA, vg$User_Score)
vg$Genre = vg$Genre %>% toupper() %>% trimws()
```
library(dplyr)
library(ggplot2)
games <- read.csv("Video_Games.csv")
games_new <- games %>%
select(-c('Publisher', 'JP_Sales', 'Critic_Count', 'User_Count', 'Developer')) %>%
transform(NA_Sales = NA_Sales * 1000000,
EU_Sales = EU_Sales * 1000000,
Global_Sales = Global_Sales * 1000000) %>%
filter(NA_Sales >= 20000 & EU_Sales >= 20000) %>%
filter(Rating == "E" | Rating == "M" | Rating == "T" | Rating == "E10+" | Rating == "AO")
sapply(games_new, class)
games_new$Year <- gsub("N/A", NA, games_new$Year)
games_new$Year <- as.numeric(games_new$Year)
unique(games_new$User_Score)
games_new$User_Score <- gsub("tbd", NA, games_new$User_Score)
games_new$User_Score <- as.numeric(games_new$User_Score)
sapply(games_new, class) # now User_Score is numeric too
games_new$Critic_Score = ifelse(games_new$Critic_Score > 100 |
games_new$Critic_Score < 0, NA, games_new$Critic_Score)
games_new$User_Score = ifelse(games_new$User_Score > 10 |
games_new$User_Score < 0, NA, games_new$User_Score)
games_new$Genre <- games_new$Genre %>% toupper() %>% trimws()
unique(games_new$Genre) # all duplicates joined in unique categories
ggplot(data = games_new, aes(x = User_Score, y = Critic_Score)) +
geom_point(color = "red", shape = 2, alpha = 0.2) +
labs(title = "Correlation plot for User Score and Critic Score",
x = "User Score", y = "Critic Score")
options(scipen = 999) # remove scientific notation
ggplot(data = games_new, aes(x = User_Score, y = Global_Sales)) +
geom_point() +
labs(title = "Correlation plot for User Score and Global Sales",
x = "User Score", y = "Global Sales") +
ylim(0, 30000000) # was not clear
ggplot(data = games_new, aes(x = User_Score, y = Global_Sales)) +
geom_point(color = "red", shape = 0, size = 1.5) +
labs(title = "User Score versus Global Sales",
x = "Score given by the User", y = "Global Sales of the game") +
ylim(0, 30000000) +
theme(axis.title = element_text(size = 15, color = "red", face = "bold"),
panel.background = element_rect(fill = "#09f2d5"),
axis.text = element_text(face = "bold", color = "black"))
ggplot(data = games_new, aes(x = Genre)) +
geom_histogram(stat = "count") +
theme(axis.text.x = element_text(angle = -60, hjust = 0)) +
labs(title = "Distribution of the Games by Genre")
ggplot(data = games_new, aes(x=User_Score, y=NA_Sales)) +
geom_point() +
facet_grid(.~Rating) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ylim(0, 5000000) +
labs(title = "User score of the game versus the North America Sales by Ratings")
ggplot(data = games_new, aes(x = Genre, y = Global_Sales)) +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(title = "Boxplots of Global Sales by Genres")
ggplot(data = games_new, aes(x = Genre, y = Global_Sales)) +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ylim(0, 2000000) +
labs(title = "Boxplots of Global Sales by Genres")
games_new %>%
group_by(Year, Global_Sales, Rating) %>%
summarise(count = n()) %>%
ggplot(aes(x = Year, y = Global_Sales, fill = Rating)) +
geom_bar(stat = "identity") +
facet_grid(.~Rating) +
labs(title = "Global Sales for Years and Ratings", y = "Global Sales")
games_new %>%
group_by(Genre) %>%
summarise(count = n()) %>%
arrange(desc(count))
games_new = games_new %>%
mutate(CU_Score = rowMeans(cbind(User_Score*10, Critic_Score)))
head(games_new$CU_Score)
top_platforms <- games_new %>%
group_by(Platform) %>%
summarise(count = n()) %>%
arrange(desc(count)) %>%
head(3)
top_platforms
top_platforms <- games_new %>%
group_by(Platform) %>%
summarise(count = n()) %>%
arrange(desc(count)) %>%
head(3)
top_platforms
View(top_platforms)
games_new$Platform <-
ifelse(games_new$Platform %in% top_platforms$Platform, games_new$Platform, "Other")
games_new <- games_new[complete.cases(games_new), ]
games_new %>%
group_by(Platform, Year) %>%
summarise(count = n()) %>%
ggplot(aes(x = Year, y = count, fill = Platform)) +
geom_bar(stat = "identity") +
facet_grid(.~Platform) +
labs(title = "Distribution of Games for Years and Platforms") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 10))
games_new$Platform <-
ifelse(games_new$Platform %in% top_platforms$Platform, games_new$Platform, "Other")
games_new <- games_new[complete.cases(games_new), ]
games_new %>%
group_by(Platform, Year) %>%
summarise(count = n()) %>%
ggplot(aes(x = Year, y = count, fill = Platform)) +
geom_bar(stat = "identity") +
facet_grid(.~Platform) +
labs(title = "Distribution of Games for Years and Platforms") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 10))
library(dplyr)
library(ggplot2)
games <- read.csv("Video_Games.csv")
games_new <- games %>%
select(-c('Publisher', 'JP_Sales', 'Critic_Count', 'User_Count', 'Developer')) %>%
transform(NA_Sales = NA_Sales * 1000000,
EU_Sales = EU_Sales * 1000000,
Global_Sales = Global_Sales * 1000000) %>%
filter(NA_Sales >= 20000 & EU_Sales >= 20000) %>%
filter(Rating == "E" | Rating == "M" | Rating == "T" | Rating == "E10+" | Rating == "AO")
sapply(games_new, class)
games_new$Year <- gsub("N/A", NA, games_new$Year)
games_new$Year <- as.numeric(games_new$Year)
unique(games_new$User_Score)
games_new$User_Score <- gsub("tbd", NA, games_new$User_Score)
games_new$User_Score <- as.numeric(games_new$User_Score)
sapply(games_new, class) # now User_Score is numeric too
games_new$Critic_Score = ifelse(games_new$Critic_Score > 100 |
games_new$Critic_Score < 0, NA, games_new$Critic_Score)
games_new$User_Score = ifelse(games_new$User_Score > 10 |
games_new$User_Score < 0, NA, games_new$User_Score)
games_new$Genre <- games_new$Genre %>% toupper() %>% trimws()
unique(games_new$Genre) # all duplicates joined in unique categories
ggplot(data = games_new, aes(x = User_Score, y = Critic_Score)) +
geom_point(color = "red", shape = 2, alpha = 0.2) +
labs(title = "Correlation plot for User Score and Critic Score",
x = "User Score", y = "Critic Score")
options(scipen = 999) # remove scientific notation
ggplot(data = games_new, aes(x = User_Score, y = Global_Sales)) +
geom_point() +
labs(title = "Correlation plot for User Score and Global Sales",
x = "User Score", y = "Global Sales") +
ylim(0, 30000000) # was not clear
ggplot(data = games_new, aes(x = User_Score, y = Global_Sales)) +
geom_point(color = "red", shape = 0, size = 1.5) +
labs(title = "User Score versus Global Sales",
x = "Score given by the User", y = "Global Sales of the game") +
ylim(0, 30000000) +
theme(axis.title = element_text(size = 15, color = "red", face = "bold"),
panel.background = element_rect(fill = "#09f2d5"),
axis.text = element_text(face = "bold", color = "black"))
ggplot(data = games_new, aes(x = Genre)) +
geom_histogram(stat = "count") +
theme(axis.text.x = element_text(angle = -60, hjust = 0)) +
labs(title = "Distribution of the Games by Genre")
ggplot(data = games_new, aes(x=User_Score, y=NA_Sales)) +
geom_point() +
facet_grid(.~Rating) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ylim(0, 5000000) +
labs(title = "User score of the game versus the North America Sales by Ratings")
ggplot(data = games_new, aes(x = Genre, y = Global_Sales)) +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(title = "Boxplots of Global Sales by Genres")
ggplot(data = games_new, aes(x = Genre, y = Global_Sales)) +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ylim(0, 2000000) +
labs(title = "Boxplots of Global Sales by Genres")
games_new %>%
group_by(Year, Global_Sales, Rating) %>%
summarise(count = n()) %>%
ggplot(aes(x = Year, y = Global_Sales, fill = Rating)) +
geom_bar(stat = "identity") +
facet_grid(.~Rating) +
labs(title = "Global Sales for Years and Ratings", y = "Global Sales")
games_new %>%
group_by(Genre) %>%
summarise(count = n()) %>%
arrange(desc(count))
games_new = games_new %>%
mutate(CU_Score = rowMeans(cbind(User_Score*10, Critic_Score)))
head(games_new$CU_Score)
top_platforms <- games_new %>%
group_by(Platform) %>%
summarise(count = n()) %>%
arrange(desc(count)) %>%
head(3)
top_platforms
games_new$Platform <-
ifelse(games_new$Platform %in% top_platforms$Platform, games_new$Platform, "Other")
top_platforms$Platform
top_platforms
games_new$Platform <-
ifelse(games_new$Platform %in% top_platforms$Platform, top_platforms$Platform, "Other")
library(dplyr)
library(ggplot2)
games <- read.csv("Video_Games.csv")
games_new <- games %>%
select(-c('Publisher', 'JP_Sales', 'Critic_Count', 'User_Count', 'Developer')) %>%
transform(NA_Sales = NA_Sales * 1000000,
EU_Sales = EU_Sales * 1000000,
Global_Sales = Global_Sales * 1000000) %>%
filter(NA_Sales >= 20000 & EU_Sales >= 20000) %>%
filter(Rating == "E" | Rating == "M" | Rating == "T" | Rating == "E10+" | Rating == "AO")
sapply(games_new, class)
games_new$Year <- gsub("N/A", NA, games_new$Year)
games_new$Year <- as.numeric(games_new$Year)
unique(games_new$User_Score)
games_new$User_Score <- gsub("tbd", NA, games_new$User_Score)
games_new$User_Score <- as.numeric(games_new$User_Score)
sapply(games_new, class) # now User_Score is numeric too
games_new$Critic_Score = ifelse(games_new$Critic_Score > 100 |
games_new$Critic_Score < 0, NA, games_new$Critic_Score)
games_new$User_Score = ifelse(games_new$User_Score > 10 |
games_new$User_Score < 0, NA, games_new$User_Score)
games_new$Genre <- games_new$Genre %>% toupper() %>% trimws()
unique(games_new$Genre) # all duplicates joined in unique categories
ggplot(data = games_new, aes(x = User_Score, y = Critic_Score)) +
geom_point(color = "red", shape = 2, alpha = 0.2) +
labs(title = "Correlation plot for User Score and Critic Score",
x = "User Score", y = "Critic Score")
options(scipen = 999) # remove scientific notation
ggplot(data = games_new, aes(x = User_Score, y = Global_Sales)) +
geom_point() +
labs(title = "Correlation plot for User Score and Global Sales",
x = "User Score", y = "Global Sales") +
ylim(0, 30000000) # was not clear
ggplot(data = games_new, aes(x = User_Score, y = Global_Sales)) +
geom_point(color = "red", shape = 0, size = 1.5) +
labs(title = "User Score versus Global Sales",
x = "Score given by the User", y = "Global Sales of the game") +
ylim(0, 30000000) +
theme(axis.title = element_text(size = 15, color = "red", face = "bold"),
panel.background = element_rect(fill = "#09f2d5"),
axis.text = element_text(face = "bold", color = "black"))
ggplot(data = games_new, aes(x = Genre)) +
geom_histogram(stat = "count") +
theme(axis.text.x = element_text(angle = -60, hjust = 0)) +
labs(title = "Distribution of the Games by Genre")
ggplot(data = games_new, aes(x=User_Score, y=NA_Sales)) +
geom_point() +
facet_grid(.~Rating) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ylim(0, 5000000) +
labs(title = "User score of the game versus the North America Sales by Ratings")
ggplot(data = games_new, aes(x = Genre, y = Global_Sales)) +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(title = "Boxplots of Global Sales by Genres")
ggplot(data = games_new, aes(x = Genre, y = Global_Sales)) +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ylim(0, 2000000) +
labs(title = "Boxplots of Global Sales by Genres")
games_new %>%
group_by(Year, Global_Sales, Rating) %>%
summarise(count = n()) %>%
ggplot(aes(x = Year, y = Global_Sales, fill = Rating)) +
geom_bar(stat = "identity") +
facet_grid(.~Rating) +
labs(title = "Global Sales for Years and Ratings", y = "Global Sales")
games_new %>%
group_by(Genre) %>%
summarise(count = n()) %>%
arrange(desc(count))
games_new = games_new %>%
mutate(CU_Score = rowMeans(cbind(User_Score*10, Critic_Score)))
head(games_new$CU_Score)
top_platforms <- games_new %>%
group_by(Platform) %>%
summarise(count = n()) %>%
arrange(desc(count)) %>%
head(3)
top_platforms
vg <- games_new
View(vg)
vg$Platform =
ifelse(vg$Platform %in% top_platforms$Platform, vg$Platform, "Other")
vg <- games_new
vg$Platform =
ifelse(vg$Platform %in% top_platforms$Platform, top_platforms$Platform, "Other")
?ifelse
?ifelse
vg <- games_new
vg$Platform <- ifelse(vg$Platform %in% top_platforms$Platform, vg$Platform, "Other")
top_platforms$Platform
vg <- games_new
vg$Platform %in% top_platforms$Platform
vg$Platform <- ifelse(vg$Platform %in% top_platforms$Platform, vg$Platform, "Other")
vg$Platform <- ifelse(vg$Platform %in% top_platforms$Platform, "gandon", "Other")
vg <- games_new
vg$Platform <- ifelse(vg$Platform %in% top_platforms$Platform, "gandon", "Other")
vg$Platform <- ifelse(vg$Platform %in% top_platforms$Platform, vg$Platform, "Other")
vg <- games_new
vg$Platform <- ifelse(vg$Platform %in% top_platforms$Platform, vg$Platform, "Other")
?if_else
vg <- games_new
vg$Platform <- if_else(vg$Platform %in% top_platforms$Platform, vg$Platform, "Other")
vg$Platform
is.character(vg$Platform)
is.factor(vg$Platform)
as.character(vg$Platform)
vg$Platform <- as.character(vg$Platform)
vg$Platform <- ifelse(vg$Platform %in% top_platforms$Platform, vg$Platform, "Other")
vg = vg[complete.cases(vg),]
vg %>%
group_by(Platform, Year) %>%
summarise(count=n()) %>%
ggplot(aes(x=Year, y=count, fill=Platform)) +
geom_bar(stat="identity") +
facet_grid(.~Platform) +
labs(title="Distribution of games for each year for each platform") +
theme(axis.text.x = element_text(angle = -90, size=6))
games <- read.csv("Video_Games.csv", stringsAsFactors = F)
library(dplyr)
library(ggplot2)
games <- read.csv("Video_Games.csv", stringsAsFactors = F)
games_new <- games %>%
select(-c('Publisher', 'JP_Sales', 'Critic_Count', 'User_Count', 'Developer')) %>%
transform(NA_Sales = NA_Sales * 1000000,
EU_Sales = EU_Sales * 1000000,
Global_Sales = Global_Sales * 1000000) %>%
filter(NA_Sales >= 20000 & EU_Sales >= 20000) %>%
filter(Rating == "E" | Rating == "M" | Rating == "T" | Rating == "E10+" | Rating == "AO")
sapply(games_new, class)
games_new$Year <- gsub("N/A", NA, games_new$Year)
games_new$Year <- as.numeric(games_new$Year)
unique(games_new$User_Score)
games_new$User_Score <- gsub("tbd", NA, games_new$User_Score)
games_new$User_Score <- as.numeric(games_new$User_Score)
sapply(games_new, class) # now User_Score is numeric too
games_new$Critic_Score = ifelse(games_new$Critic_Score > 100 |
games_new$Critic_Score < 0, NA, games_new$Critic_Score)
games_new$User_Score = ifelse(games_new$User_Score > 10 |
games_new$User_Score < 0, NA, games_new$User_Score)
games_new$Genre <- games_new$Genre %>% toupper() %>% trimws()
unique(games_new$Genre) # all duplicates joined in unique categories
ggplot(data = games_new, aes(x = User_Score, y = Critic_Score)) +
geom_point(color = "red", shape = 2, alpha = 0.2) +
labs(title = "Correlation plot for User Score and Critic Score",
x = "User Score", y = "Critic Score")
options(scipen = 999) # remove scientific notation
ggplot(data = games_new, aes(x = User_Score, y = Global_Sales)) +
geom_point() +
labs(title = "Correlation plot for User Score and Global Sales",
x = "User Score", y = "Global Sales") +
ylim(0, 30000000) # was not clear
ggplot(data = games_new, aes(x = User_Score, y = Global_Sales)) +
geom_point(color = "red", shape = 0, size = 1.5) +
labs(title = "User Score versus Global Sales",
x = "Score given by the User", y = "Global Sales of the game") +
ylim(0, 30000000) +
theme(axis.title = element_text(size = 15, color = "red", face = "bold"),
panel.background = element_rect(fill = "#09f2d5"),
axis.text = element_text(face = "bold", color = "black"))
ggplot(data = games_new, aes(x = Genre)) +
geom_histogram(stat = "count") +
theme(axis.text.x = element_text(angle = -60, hjust = 0)) +
labs(title = "Distribution of the Games by Genre")
ggplot(data = games_new, aes(x=User_Score, y=NA_Sales)) +
geom_point() +
facet_grid(.~Rating) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ylim(0, 5000000) +
labs(title = "User score of the game versus the North America Sales by Ratings")
ggplot(data = games_new, aes(x = Genre, y = Global_Sales)) +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(title = "Boxplots of Global Sales by Genres")
ggplot(data = games_new, aes(x = Genre, y = Global_Sales)) +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ylim(0, 2000000) +
labs(title = "Boxplots of Global Sales by Genres")
games_new %>%
group_by(Year, Global_Sales, Rating) %>%
summarise(count = n()) %>%
ggplot(aes(x = Year, y = Global_Sales, fill = Rating)) +
geom_bar(stat = "identity") +
facet_grid(.~Rating) +
labs(title = "Global Sales for Years and Ratings", y = "Global Sales")
games_new %>%
group_by(Genre) %>%
summarise(count = n()) %>%
arrange(desc(count))
games_new = games_new %>%
mutate(CU_Score = rowMeans(cbind(User_Score*10, Critic_Score)))
head(games_new$CU_Score)
top_platforms <- games_new %>%
group_by(Platform) %>%
summarise(count = n()) %>%
arrange(desc(count)) %>%
head(3)
top_platforms
games_new$Platform <-
ifelse(games_new$Platform %in% top_platforms$Platform, top_platforms$Platform, "Other")
games_new <- games_new[complete.cases(games_new), ]
games_new %>%
group_by(Platform, Year) %>%
summarise(count = n()) %>%
ggplot(aes(x = Year, y = count, fill = Platform)) +
geom_bar(stat = "identity") +
facet_grid(.~Platform) +
labs(title = "Distribution of Games for Years and Platforms") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 10))
games %>%
group_by(Platform, Year) %>%
summarise(count = n()) %>%
ggplot(aes(x = Year, y = count, fill = Platform)) +
geom_bar(stat = "identity") +
facet_grid(.~Platform) +
labs(title = "Distribution of Games for Years and Platforms") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 10))
games_new %>%
group_by(Platform, Year) %>%
summarise(count = n()) %>%
ggplot(aes(x = Year, y = count, fill = Platform)) +
geom_bar(stat = "identity") +
facet_grid(.~Platform) +
labs(title = "Distribution of Games for Years and Platforms") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 10))
vg <- games
vg$Platform <- as.character(vg$Platform)
vg <- games
vg$Platform <- as.character(vg$Platform)
vg$Platform <- ifelse(vg$Platform %in% top_platforms$Platform, vg$Platform, "Other")
vg = vg[complete.cases(vg),]
vg %>%
group_by(Platform, Year) %>%
summarise(count=n()) %>%
ggplot(aes(x=Year, y=count, fill=Platform)) +
geom_bar(stat="identity") +
facet_grid(.~Platform) +
labs(title="Distribution of games for each year for each platform") +
theme(axis.text.x = element_text(angle = -90, size=6))
games_new %>%
group_by(Platform, Year) %>%
summarise(count = n()) %>%
ggplot(aes(x = Year, y = count, fill = Platform)) +
geom_bar(stat = "identity") +
facet_grid(.~Platform) +
labs(title = "Distribution of Games for Years and Platforms", y = "Number of Games") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 10))
games_new$Platform <-
ifelse(games_new$Platform %in% top_platforms$Platform, top_platforms$Platform, "Other")
games_new <- games_new[complete.cases(games_new), ]
games_new %>%
group_by(Platform, Year) %>%
summarise(count = n()) %>%
ggplot(aes(x = Year, y = count, fill = Platform)) +
geom_bar(stat = "identity") +
facet_grid(.~Platform) +
labs(title = "Distribution of Games for Years and Platforms", y = "Number of Games") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 10))
```{r, echo = FALSE}
library(dplyr)
library(ggplot2)
library(dplyr)
library(ggplot2)
library(dplyr)
library(ggplot2)
